<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ADNIMERGE2-Analysis-Data â€¢ ADNIMERGE2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ADNIMERGE2-Analysis-Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ADNIMERGE2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>R Package Build</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Package-Building.html">Building an R Package from Raw Dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Metadata Specs</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Analysis-Meta-Specs.html">ADNIMERGE2 Analysis Metadata Specs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Derived/Analysis Ready Data</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Derived-Data.html">ADNIMERGE2 Derived Data</a></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Analysis-Data.html">ADNIMERGE2 Analysis Ready Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/ADNI-Enrollment.html">ADNI Enrollment</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atri-biostats/ADNIMERGE2/" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="ADNIMERGE2-Analysis-Data_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="ADNIMERGE2-Analysis-Data_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="ADNIMERGE2-Analysis-Data_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="ADNIMERGE2-Analysis-Data_files/datatables-binding-0.33/datatables.js"></script><link href="ADNIMERGE2-Analysis-Data_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="ADNIMERGE2-Analysis-Data_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="ADNIMERGE2-Analysis-Data_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="ADNIMERGE2-Analysis-Data_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="ADNIMERGE2-Analysis-Data_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ADNIMERGE2-Analysis-Data</h1>
            
            <h4 data-toc-skip class="date">Last Updated: April 17,
2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/atri-biostats/ADNIMERGE2/blob/HEAD/vignettes/ADNIMERGE2-Analysis-Data.Rmd" class="external-link"><code>vignettes/ADNIMERGE2-Analysis-Data.Rmd</code></a></small>
      <div class="d-none name"><code>ADNIMERGE2-Analysis-Data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article describes creating analysis ready dataset using the <a href="https://pharmaverse.org/" class="external-link">PHARMERVERSE</a> workflow. It uses some
pre-generated standardized dataset and a metadata-specs as input. Please
refer to the following articles to see how the derived dataset and
metadata-specs are generated.</p>
<ul>
<li><a href="ADNIMERGE2-Derived-Data.html">ADNIMERGE2-Derived-Data</a></li>
<li><a href="ADNIMERGE2-Analysis-Meta-Specs.html">ADNIMERGE2-Analysis-Meta-Specs</a></li>
</ul>
<p>In ADNI study, the following selected analysis ready dataset will be
created for illustration purpose.</p>
<ul>
<li>Subject-Level Analysis Dataset - ADSL</li>
<li>Analysis Dataset of Adverse Events - ADAE</li>
<li>Analysis Dataset of Questionnaire - ADQS</li>
</ul>
<p><strong>NOTE</strong></p>
<ul>
<li><em>These anlaysis ready dataset may not be fully complied with tthe
CDISC-ADaM standardization. More information about the CDISC-ADaM can be
found <a href="https://www.cdisc.org/standards/foundational/adam" class="external-link">here</a>.</em></li>
</ul>
</div>
<div class="section level2">
<h2 id="load-required-r-packages">Load Required R Packages<a class="anchor" aria-label="anchor" href="#load-required-r-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/assertr/" class="external-link">assertr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pharmaverse/metatools" class="external-link">metatools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/admiral/" class="external-link">admiral</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/admiraldev/" class="external-link">admiraldev</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atorus-research.github.io/xportr/" class="external-link">xportr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ADNI study R data package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atri-biostats.github.io/ADNIMERGE2">ADNIMERGE2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="building-analysis-ready-dataset">Building Analysis Ready Dataset<a class="anchor" aria-label="anchor" href="#building-analysis-ready-dataset"></a>
</h2>
<div class="section level3">
<h3 id="subject-level-analysis-dataset---adsl">Subject-Level Analysis Dataset - ADSL<a class="anchor" aria-label="anchor" href="#subject-level-analysis-dataset---adsl"></a>
</h3>
<p><a href="../reference/ADSL.html"><code>ADSL</code></a> dataset
contains one records per participant. In ADNI study, <a href="../reference/ADSL.html"><code>ADSL</code></a> dataset includes
only the first records/baseline characteristics of participant when they
were enrolled in the study as newly-enrollee or screened to the study
for the first time.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28"],["STUDYID","USUBJID","SUBJID","SITEID","ORIGPROT","AGE","AGEU","AGEGR1N","AGEGR1","SEX","RACE","RACEN","ETHNIC","ENRLFL","DTHFL","ARM","ACTARM","ENRLDT","EOSDT","EOSDTF","DTHDT","DTHDTF","EDUC","MARISTAT","BMI","BMIBLU","DX","AMYSTAT"],["Study Identifier","Unique Subject Identifier","Subject Identifier for the Study","Study Site Identifier","Original Study Protocol","Age (in Years)","Age Units","Pooled Age Group 1 (N)","Pooled Age Group 1","Sex","Race","Race (N)","Ethnicity","Enrolled Population Flag","Death Flag","Description of Planned Arm","Description of Actual Arm","Date of Enrollment","End of Study Date","End of Study Date Imputation Flag","Date of Death","Date of Death Imputation Flag","Education","Marital Status","Body Mass Index","Body Mass Index Unit","Baseline Diagnostics Status","Baseline Amyloid Status"],["TEXT","TEXT","TEXT","TEXT","TEXT","FLOAT","TEXT","INTEGER","TEXT","TEXT","TEXT","INTEGER","TEXT","TEXT","TEXT","TEXT","TEXT","DATE","DATE","TEXT","DATE","TEXT","FLOAT","TEXT","FLOAT","TEXT","TEXT","TEXT"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>FLDNAME<\/th>\n      <th>LABEL<\/th>\n      <th>TYPE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"searchable":["function (..., list = character(), package = NULL, lib.loc = NULL, ","    verbose = getOption(\"verbose\"), envir = .GlobalEnv, overwrite = TRUE) ","{","    fileExt <- function(x) {","        db <- grepl(\"\\\\.[^.]+\\\\.(gz|bz2|xz)$\", x)","        ans <- sub(\".*\\\\.\", \"\", x)","        ans[db] <- sub(\".*\\\\.([^.]+\\\\.)(gz|bz2|xz)$\", \"\\\\1\\\\2\", ","            x[db])","        ans","    }","    my_read_table <- function(...) {","        lcc <- Sys.getlocale(\"LC_COLLATE\")","        on.exit(Sys.setlocale(\"LC_COLLATE\", lcc))","        Sys.setlocale(\"LC_COLLATE\", \"C\")","        read.table(...)","    }","    stopifnot(is.character(list))","    names <- c(as.character(substitute(list(...))[-1L]), list)","    if (!is.null(package)) {","        if (!is.character(package)) ","            stop(\"'package' must be a character vector or NULL\")","    }","    paths <- find.package(package, lib.loc, verbose = verbose)","    if (is.null(lib.loc)) ","        paths <- c(path.package(package, TRUE), if (!length(package)) getwd(), ","            paths)","    paths <- unique(normalizePath(paths[file.exists(paths)]))","    paths <- paths[dir.exists(file.path(paths, \"data\"))]","    dataExts <- tools:::.make_file_exts(\"data\")","    if (length(names) == 0L) {","        db <- matrix(character(), nrow = 0L, ncol = 4L)","        for (path in paths) {","            entries <- NULL","            packageName <- if (file_test(\"-f\", file.path(path, ","                \"DESCRIPTION\"))) ","                basename(path)","            else \".\"","            if (file_test(\"-f\", INDEX <- file.path(path, \"Meta\", ","                \"data.rds\"))) {","                entries <- readRDS(INDEX)","            }","            else {","                dataDir <- file.path(path, \"data\")","                entries <- tools::list_files_with_type(dataDir, ","                  \"data\")","                if (length(entries)) {","                  entries <- unique(tools::file_path_sans_ext(basename(entries)))","                  entries <- cbind(entries, \"\")","                }","            }","            if (NROW(entries)) {","                if (is.matrix(entries) && ncol(entries) == 2L) ","                  db <- rbind(db, cbind(packageName, dirname(path), ","                    entries))","                else warning(gettextf(\"data index for package %s is invalid and will be ignored\", ","                  sQuote(packageName)), domain = NA, call. = FALSE)","            }","        }","        colnames(db) <- c(\"Package\", \"LibPath\", \"Item\", \"Title\")","        footer <- if (missing(package)) ","            paste0(\"Use \", sQuote(paste(\"data(package =\", \".packages(all.available = TRUE))\")), ","                \"\\n\", \"to list the data sets in all *available* packages.\")","        else NULL","        y <- list(title = \"Data sets\", header = NULL, results = db, ","            footer = footer)","        class(y) <- \"packageIQR\"","        return(y)","    }","    paths <- file.path(paths, \"data\")","    for (name in names) {","        found <- FALSE","        for (p in paths) {","            tmp_env <- if (overwrite) ","                envir","            else new.env()","            if (file_test(\"-f\", file.path(p, \"Rdata.rds\"))) {","                rds <- readRDS(file.path(p, \"Rdata.rds\"))","                if (name %in% names(rds)) {","                  found <- TRUE","                  if (verbose) ","                    message(sprintf(\"name=%s:\\t found in Rdata.rds\", ","                      name), domain = NA)","                  thispkg <- sub(\".*/([^/]*)/data$\", \"\\\\1\", p)","                  thispkg <- sub(\"_.*$\", \"\", thispkg)","                  thispkg <- paste0(\"package:\", thispkg)","                  objs <- rds[[name]]","                  lazyLoad(file.path(p, \"Rdata\"), envir = tmp_env, ","                    filter = function(x) x %in% objs)","                  break","                }","                else if (verbose) ","                  message(sprintf(\"name=%s:\\t NOT found in names() of Rdata.rds, i.e.,\\n\\t%s\\n\", ","                    name, paste(names(rds), collapse = \",\")), ","                    domain = NA)","            }","            files <- list.files(p, full.names = TRUE)","            files <- files[grep(name, files, fixed = TRUE)]","            if (length(files) > 1L) {","                o <- match(fileExt(files), dataExts, nomatch = 100L)","                paths0 <- dirname(files)","                paths0 <- factor(paths0, levels = unique(paths0))","                files <- files[order(paths0, o)]","            }","            if (length(files)) {","                for (file in files) {","                  if (verbose) ","                    message(\"name=\", name, \":\\t file= ...\", .Platform$file.sep, ","                      basename(file), \"::\\t\", appendLF = FALSE, ","                      domain = NA)","                  ext <- fileExt(file)","                  if (basename(file) != paste0(name, \".\", ext)) ","                    found <- FALSE","                  else {","                    found <- TRUE","                    switch(ext, R = , r = {","                      library(\"utils\")","                      sys.source(file, chdir = TRUE, envir = tmp_env)","                    }, RData = , rdata = , rda = load(file, envir = tmp_env), ","                      TXT = , txt = , tab = , tab.gz = , tab.bz2 = , ","                      tab.xz = , txt.gz = , txt.bz2 = , txt.xz = assign(name, ","                        my_read_table(file, header = TRUE, as.is = FALSE), ","                        envir = tmp_env), CSV = , csv = , csv.gz = , ","                      csv.bz2 = , csv.xz = assign(name, my_read_table(file, ","                        header = TRUE, sep = \";\", as.is = FALSE), ","                        envir = tmp_env), found <- FALSE)","                  }","                  if (found) ","                    break","                }","                if (verbose) ","                  message(if (!found) ","                    \"*NOT* \", \"found\", domain = NA)","            }","            if (found) ","                break","        }","        if (!found) {","            warning(gettextf(\"data set %s not found\", sQuote(name)), ","                domain = NA)","        }","        else if (!overwrite) {","            for (o in ls(envir = tmp_env, all.names = TRUE)) {","                if (exists(o, envir = envir, inherits = FALSE)) ","                  warning(gettextf(\"an object named %s already exists and will not be overwritten\", ","                    sQuote(o)))","                else assign(o, get(o, envir = tmp_env, inherits = FALSE), ","                  envir = envir)","            }","            rm(tmp_env)","        }","    }","    invisible(names)","}"],"bInfo":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"FLDNAME","targets":1},{"name":"LABEL","targets":2},{"name":"TYPE","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/build_from_derived.html" class="external-link">build_from_derived</a></span><span class="op">(</span></span>
<span>  metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>  ds_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"DM"</span> <span class="op">=</span> <span class="va">DM</span><span class="op">)</span>,</span>
<span>  predecessor_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Create AGE Group - creating categorical group from numeric</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/create_cat_var.html" class="external-link">create_cat_var</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    ref_var <span class="op">=</span> <span class="va">AGE</span>,</span>
<span>    grp_var <span class="op">=</span> <span class="va">AGEGR1</span>,</span>
<span>    num_grp_var <span class="op">=</span> <span class="va">AGEGR1N</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Re-code RACE</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/create_var_from_codelist.html" class="external-link">create_var_from_codelist</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    input_var <span class="op">=</span> <span class="va">RACE</span>,</span>
<span>    out_var <span class="op">=</span> <span class="va">RACEN</span>,</span>
<span>    decode_to_code <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add baseline DX</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_merged.html" class="external-link">derive_vars_merged</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">RS</span>,</span>
<span>    filter_add <span class="op">=</span> <span class="va">RSTESTCD</span> <span class="op">==</span> <span class="st">"DX"</span> <span class="op">&amp;</span> <span class="va">RSBLFL</span> <span class="op">==</span> <span class="st">"Yes"</span>,</span>
<span>    new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>DX <span class="op">=</span> <span class="va">RSORRES</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    mode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"one-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Convert to factor with Control Terms (CT)</span></span>
<span>  <span class="fu">convert_var_to_fct_wrapper</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"ADSL"</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ORIGPROT"</span>, <span class="st">"DX"</span>, <span class="st">"RACE"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add baseline amyloid status</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/call_derivation.html" class="external-link">call_derivation</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">NV</span>,</span>
<span>    derivation <span class="op">=</span> <span class="va">derive_vars_merged</span>,</span>
<span>    variable_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        filter_add <span class="op">=</span> <span class="va">NVTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"AMYSTAT"</span> <span class="op">&amp;</span> <span class="va">NVBLFL</span> <span class="op">==</span> <span class="st">"Yes"</span>,</span>
<span>        new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>AMYSTAT <span class="op">=</span> <span class="va">NVSTRESC</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"one-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add baseline education level and marital status</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/call_derivation.html" class="external-link">call_derivation</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">SC</span>,</span>
<span>    derivation <span class="op">=</span> <span class="va">derive_vars_merged</span>,</span>
<span>    variable_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        filter_add <span class="op">=</span> <span class="va">SCTESTCD</span> <span class="op">==</span> <span class="st">"PTEDUCAT"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SCORRES</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VISITNUM</span> <span class="op">&lt;=</span> <span class="fl">1</span>,</span>
<span>        new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>EDUC <span class="op">=</span> <span class="va">SCSTRESN</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        filter_add <span class="op">=</span> <span class="va">SCTESTCD</span> <span class="op">==</span> <span class="st">"PTMARRY"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SCORRES</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VISITNUM</span> <span class="op">&lt;=</span> <span class="fl">1</span>,</span>
<span>        new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>MARISTAT <span class="op">=</span> <span class="va">SCORRES</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">VISITNUM</span><span class="op">)</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"first"</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"one-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add baseline BMI derived from weight and height</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/call_derivation.html" class="external-link">call_derivation</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">VS</span>,</span>
<span>    derivation <span class="op">=</span> <span class="va">derive_vars_merged</span>,</span>
<span>    variable_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        filter_add <span class="op">=</span> <span class="va">VSTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"WEIGHT"</span> <span class="op">&amp;</span> <span class="va">VSBLFL</span> <span class="op">==</span> <span class="st">"Yes"</span>,</span>
<span>        new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>WEIGHT <span class="op">=</span> <span class="va">VSSTRESN</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        filter_add <span class="op">=</span> <span class="va">VSTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"HEIGHT"</span> <span class="op">&amp;</span> <span class="va">VSBLFL</span> <span class="op">==</span> <span class="st">"Yes"</span>,</span>
<span>        new_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span>HEIGHT <span class="op">=</span> <span class="va">VSSTRESN</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"one-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    BMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/compute_bmi.html" class="external-link">compute_bmi</a></span><span class="op">(</span>height <span class="op">=</span> <span class="va">HEIGHT</span>, weight <span class="op">=</span> <span class="va">WEIGHT</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    BMIBLU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span>, <span class="st">"kg/m^2"</span>, <span class="cn">NA_character_</span><span class="op">)</span>,</span>
<span>    AGEU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">AGEU</span><span class="op">)</span>, <span class="st">"Years"</span>, <span class="cn">NA_character_</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Create Enrollment Flag</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_var_merged_ef_msrc.html" class="external-link">derive_var_merged_ef_msrc</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    flag_events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/flag_event.html" class="external-link">flag_event</a></span><span class="op">(</span>dataset_name <span class="op">=</span> <span class="st">"DM"</span>, condition <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">RFSTDTC</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DM <span class="op">=</span> <span class="va">DM</span><span class="op">)</span>,</span>
<span>    new_var <span class="op">=</span> <span class="va">ENRLFL</span>,</span>
<span>    true_value <span class="op">=</span> <span class="st">"Yes"</span>,</span>
<span>    false_value <span class="op">=</span> <span class="st">"No"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Imputation for death date and enrollment end date</span></span>
<span>  <span class="co"># Required parital date/time, in character format</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"EOSDTHC"</span> <span class="op">=</span> <span class="va">EOSDT</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">DTHDT</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    EOSDTHC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">EOSDTHC</span><span class="op">)</span>,</span>
<span>    DTHDTC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">DTHDTC</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/call_derivation.html" class="external-link">call_derivation</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    derivation <span class="op">=</span> <span class="va">derive_vars_dtm</span>,</span>
<span>    variable_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span>dtc <span class="op">=</span> <span class="va">DTHDTC</span>, new_vars_prefix <span class="op">=</span> <span class="st">"DTH"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span>dtc <span class="op">=</span> <span class="va">EOSDTHC</span>, new_vars_prefix <span class="op">=</span> <span class="st">"EOS"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    highest_imputation <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>    date_imputation <span class="op">=</span> <span class="st">"mid"</span>,</span>
<span>    flag_imputation <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>    min_dates <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ENRLDT</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_dtm_to_dt.html" class="external-link">derive_vars_dtm_to_dt</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    source_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">DTHDTM</span>, <span class="va">EOSDTM</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove any columns that are not specified in the meta-specs</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/drop_unspec_vars.html" class="external-link">drop_unspec_vars</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    dataset_name <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add variable labels</span></span>
<span>  <span class="fu">metatools</span><span class="fu">::</span><span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/set_variable_labels.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    dataset_name <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op">&lt;-</span> <span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Check all variables specified are present and no more</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_variables.html" class="external-link">check_variables</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    dataset_name <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Checks all variables with CT only contain values within the CT</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_ct_data.html" class="external-link">check_ct_data</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span><span class="op">)</span>,</span>
<span>    na_acceptable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    omit_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENRLFL"</span>, <span class="st">"DTHFL"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Orders the columns according to the spec</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/order_cols.html" class="external-link">order_cols</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    dataset_name <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Sort the dataset based on key columns</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/sort_by_key.html" class="external-link">sort_by_key</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    dataset_name <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Check uniqueness of records by key columns</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_unique_keys.html" class="external-link">check_unique_keys</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">METACORES</span>,</span>
<span>    datase <span class="op">=</span> <span class="st">"ADSL"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op">&lt;-</span> <span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/metadata.html" class="external-link">xportr_metadata</a></span><span class="op">(</span></span>
<span>    .df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">METACORES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span><span class="op">)</span>,</span>
<span>    domain <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="st">"stop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Check variable type with specs match</span></span>
<span>  <span class="co"># xportr_type() %&gt;%</span></span>
<span>  <span class="co"># Assign variable value length from the meta specs</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_length.html" class="external-link">xportr_length</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Assign variable label from meta specs and</span></span>
<span>  <span class="co"># checks variable label length for max of 40 characters</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_label.html" class="external-link">xportr_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Checks variable format</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_format.html" class="external-link">xportr_format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-dataset-of-adverse-events---adae">Analysis Dataset of Adverse Events - ADAE<a class="anchor" aria-label="anchor" href="#analysis-dataset-of-adverse-events---adae"></a>
</h3>
<p><a href="../reference/ADAE.html"><code>ADAE</code></a> dataset
contains one records per adverse events per participant with the
following characteristics.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62"],["STUDYID","USUBJID","SUBJID","SITEID","TRTA","TRTP","AGE","AGEU","AGEGR1","AGEGR1N","SEX","RACE","RACEN","ETHNIC","DX","ENRLFL","ENRLDT","EOSDT","EOSDTF","ASTDT","ASTDTF","ASTDY","AENDT","AENDTF","AENDY","ADURN","ADURU","AETERM","AELLT","AELLTCD","AEDECOD","AEPTCD","AEHLT","AEHLTCD","AEHLGT","AEHLGTCD","AESOC","AESOCCD","AESEV","AESER","AESCONG","AESDISAB","AESDTH","AESHOSP","AESLIFE","AESMIE","AERELCM","AERELFLRBTBN","AERELFLRBPR","AEHIMG","AERELTAU","AERELNAV","AERELMK","AERELPI","AEHLUMB","AERELCOVID","AERELPAN","AERELAD","AERELATESP","AECONTRT","AEOUT","AESEQ"],["Study Identifier","Unique Subject Identifier","Subject Identifier for the Study","Study Site Identifier","Actual Arm","Planned Arm","Age (in Years)","Age Units","Pooled Age Group 1","Pooled Age Group 1 (N)","Sex","Race","Race (N)","Ethnicity","Baseline Diagnostics Status","Enrolled Population Flag","Date of Enrollment","End of Study Date","End of Study Date Imputation Flag","Analysis Start Date","Analysis Start Date Imputation Flag","Analysis Start Relative Day","Analysis End Date","Analysis End Date Imputation Flag","Analysis End Relative Day","Adverse Events Duration (N)","Analysis Duration Unit","Reported Term for the Adverse Event","Lowest Level Term","Lowest Level Term Code","Dictionary-Derived Term","Preferred Term Code","High Level Term","High Level Term Code","High Level Group Term","High Level Group Term Code","Primary Sytem Organ Class","Primary Sytem Organ Class Code","Severity/Intensity","Serious Event","Congenital Anomaly or Birth Defect","Persist or Signif Disability/Incapacity","Results in Death","Requires or Prologns Hospitalization","Is Life Threating","Other Medically Important Serious Event","Related to Concomitant Therapy","Related to Florbetaben Tracer","Related to Florbetapir Tracer","Related to PET/MRI Imaging Procedure","Related to Flotaucipir Tracer","Related to NAV-4694 Tracer","Related to MK-6240 Tracer","Related to PI-2620 Tracer","Related to Lumbar Puncture","Related to COVID-19 Illness","Related to COVID-19 Pandemic Disruption","Related to Early Stage/Progression of AD","Related to Other Study Procedure(s)","Concomitant or Additional Trtmnt Given","Outcome of Adverse Event","Sequence Number"],["TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","FLOAT","TEXT","TEXT","INTEGER","TEXT","TEXT","INTEGER","TEXT","TEXT","TEXT","DATE","DATE","TEXT","DATE","TEXT","INTEGER","DATE","TEXT","INTEGER","INTEGER","TEXT","TEXT","TEXT","INTEGER","TEXT","INTEGER","TEXT","INTEGER","TEXT","INTEGER","TEXT","INTEGER","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","TEXT","INTEGER"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>FLDNAME<\/th>\n      <th>LABEL<\/th>\n      <th>TYPE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"searchable":["function (..., list = character(), package = NULL, lib.loc = NULL, ","    verbose = getOption(\"verbose\"), envir = .GlobalEnv, overwrite = TRUE) ","{","    fileExt <- function(x) {","        db <- grepl(\"\\\\.[^.]+\\\\.(gz|bz2|xz)$\", x)","        ans <- sub(\".*\\\\.\", \"\", x)","        ans[db] <- sub(\".*\\\\.([^.]+\\\\.)(gz|bz2|xz)$\", \"\\\\1\\\\2\", ","            x[db])","        ans","    }","    my_read_table <- function(...) {","        lcc <- Sys.getlocale(\"LC_COLLATE\")","        on.exit(Sys.setlocale(\"LC_COLLATE\", lcc))","        Sys.setlocale(\"LC_COLLATE\", \"C\")","        read.table(...)","    }","    stopifnot(is.character(list))","    names <- c(as.character(substitute(list(...))[-1L]), list)","    if (!is.null(package)) {","        if (!is.character(package)) ","            stop(\"'package' must be a character vector or NULL\")","    }","    paths <- find.package(package, lib.loc, verbose = verbose)","    if (is.null(lib.loc)) ","        paths <- c(path.package(package, TRUE), if (!length(package)) getwd(), ","            paths)","    paths <- unique(normalizePath(paths[file.exists(paths)]))","    paths <- paths[dir.exists(file.path(paths, \"data\"))]","    dataExts <- tools:::.make_file_exts(\"data\")","    if (length(names) == 0L) {","        db <- matrix(character(), nrow = 0L, ncol = 4L)","        for (path in paths) {","            entries <- NULL","            packageName <- if (file_test(\"-f\", file.path(path, ","                \"DESCRIPTION\"))) ","                basename(path)","            else \".\"","            if (file_test(\"-f\", INDEX <- file.path(path, \"Meta\", ","                \"data.rds\"))) {","                entries <- readRDS(INDEX)","            }","            else {","                dataDir <- file.path(path, \"data\")","                entries <- tools::list_files_with_type(dataDir, ","                  \"data\")","                if (length(entries)) {","                  entries <- unique(tools::file_path_sans_ext(basename(entries)))","                  entries <- cbind(entries, \"\")","                }","            }","            if (NROW(entries)) {","                if (is.matrix(entries) && ncol(entries) == 2L) ","                  db <- rbind(db, cbind(packageName, dirname(path), ","                    entries))","                else warning(gettextf(\"data index for package %s is invalid and will be ignored\", ","                  sQuote(packageName)), domain = NA, call. = FALSE)","            }","        }","        colnames(db) <- c(\"Package\", \"LibPath\", \"Item\", \"Title\")","        footer <- if (missing(package)) ","            paste0(\"Use \", sQuote(paste(\"data(package =\", \".packages(all.available = TRUE))\")), ","                \"\\n\", \"to list the data sets in all *available* packages.\")","        else NULL","        y <- list(title = \"Data sets\", header = NULL, results = db, ","            footer = footer)","        class(y) <- \"packageIQR\"","        return(y)","    }","    paths <- file.path(paths, \"data\")","    for (name in names) {","        found <- FALSE","        for (p in paths) {","            tmp_env <- if (overwrite) ","                envir","            else new.env()","            if (file_test(\"-f\", file.path(p, \"Rdata.rds\"))) {","                rds <- readRDS(file.path(p, \"Rdata.rds\"))","                if (name %in% names(rds)) {","                  found <- TRUE","                  if (verbose) ","                    message(sprintf(\"name=%s:\\t found in Rdata.rds\", ","                      name), domain = NA)","                  thispkg <- sub(\".*/([^/]*)/data$\", \"\\\\1\", p)","                  thispkg <- sub(\"_.*$\", \"\", thispkg)","                  thispkg <- paste0(\"package:\", thispkg)","                  objs <- rds[[name]]","                  lazyLoad(file.path(p, \"Rdata\"), envir = tmp_env, ","                    filter = function(x) x %in% objs)","                  break","                }","                else if (verbose) ","                  message(sprintf(\"name=%s:\\t NOT found in names() of Rdata.rds, i.e.,\\n\\t%s\\n\", ","                    name, paste(names(rds), collapse = \",\")), ","                    domain = NA)","            }","            files <- list.files(p, full.names = TRUE)","            files <- files[grep(name, files, fixed = TRUE)]","            if (length(files) > 1L) {","                o <- match(fileExt(files), dataExts, nomatch = 100L)","                paths0 <- dirname(files)","                paths0 <- factor(paths0, levels = unique(paths0))","                files <- files[order(paths0, o)]","            }","            if (length(files)) {","                for (file in files) {","                  if (verbose) ","                    message(\"name=\", name, \":\\t file= ...\", .Platform$file.sep, ","                      basename(file), \"::\\t\", appendLF = FALSE, ","                      domain = NA)","                  ext <- fileExt(file)","                  if (basename(file) != paste0(name, \".\", ext)) ","                    found <- FALSE","                  else {","                    found <- TRUE","                    switch(ext, R = , r = {","                      library(\"utils\")","                      sys.source(file, chdir = TRUE, envir = tmp_env)","                    }, RData = , rdata = , rda = load(file, envir = tmp_env), ","                      TXT = , txt = , tab = , tab.gz = , tab.bz2 = , ","                      tab.xz = , txt.gz = , txt.bz2 = , txt.xz = assign(name, ","                        my_read_table(file, header = TRUE, as.is = FALSE), ","                        envir = tmp_env), CSV = , csv = , csv.gz = , ","                      csv.bz2 = , csv.xz = assign(name, my_read_table(file, ","                        header = TRUE, sep = \";\", as.is = FALSE), ","                        envir = tmp_env), found <- FALSE)","                  }","                  if (found) ","                    break","                }","                if (verbose) ","                  message(if (!found) ","                    \"*NOT* \", \"found\", domain = NA)","            }","            if (found) ","                break","        }","        if (!found) {","            warning(gettextf(\"data set %s not found\", sQuote(name)), ","                domain = NA)","        }","        else if (!overwrite) {","            for (o in ls(envir = tmp_env, all.names = TRUE)) {","                if (exists(o, envir = envir, inherits = FALSE)) ","                  warning(gettextf(\"an object named %s already exists and will not be overwritten\", ","                    sQuote(o)))","                else assign(o, get(o, envir = tmp_env, inherits = FALSE), ","                  envir = envir)","            }","            rm(tmp_env)","        }","    }","    invisible(names)","}"],"bInfo":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"FLDNAME","targets":1},{"name":"LABEL","targets":2},{"name":"TYPE","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adae_metacore</span> <span class="op">&lt;-</span> <span class="va">METACORES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">.</span>, dataset <span class="op">=</span> <span class="st">"ADAE"</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modified user-defined function</span></span>
<span><span class="va">ADAE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/build_from_derived.html" class="external-link">build_from_derived</a></span><span class="op">(</span></span>
<span>  metacore <span class="op">=</span> <span class="va">adae_metacore</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"ADAE"</span>,</span>
<span>  ds_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ADSL"</span> <span class="op">=</span> <span class="va">ADSL</span>, <span class="st">"AE"</span> <span class="op">=</span> <span class="va">AE</span><span class="op">)</span>,</span>
<span>  predecessor_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Only participant that had at least one adverse events experience</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">USUBJID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AE</span><span class="op">$</span><span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/verify.html" class="external-link">verify</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">AE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add adverse events onset and ended date</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_merged.html" class="external-link">derive_vars_merged</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">AE</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AETERM</span>, <span class="va">AESEQ</span>, <span class="va">AESTDTC</span>, <span class="va">AEENDTC</span><span class="op">)</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AETERM</span>, <span class="va">AESEQ</span><span class="op">)</span>,</span>
<span>    new_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"one-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># AESTDTC and AEENDTC required to be a character variable</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    AESTDTC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">AESTDTC</span><span class="op">)</span>,</span>
<span>    AEENDTC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">AEENDTC</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add imputed date death date from ADSL</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_merged.html" class="external-link">derive_vars_merged</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STUDYID</span>, <span class="va">DTHDT</span><span class="op">)</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STUDYID</span><span class="op">)</span>,</span>
<span>    new_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive analysis start and end date</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/call_derivation.html" class="external-link">call_derivation</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    derivation <span class="op">=</span> <span class="va">derive_vars_dtm</span>,</span>
<span>    variable_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        dtc <span class="op">=</span> <span class="va">AESTDTC</span>, new_vars_prefix <span class="op">=</span> <span class="st">"AST"</span>, highest_imputation <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>        date_imputation <span class="op">=</span> <span class="st">"first"</span>, time_imputation <span class="op">=</span> <span class="st">"first"</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>        dtc <span class="op">=</span> <span class="va">AEENDTC</span>, new_vars_prefix <span class="op">=</span> <span class="st">"AEN"</span>, highest_imputation <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>        date_imputation <span class="op">=</span> <span class="st">"last"</span>, time_imputation <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>        max_dates <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">DTHDT</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    flag_imputation <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>    min_dates <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ENRLDT</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Convert into date format</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_dtm_to_dt.html" class="external-link">derive_vars_dtm_to_dt</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    source_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ASTDTM</span>, <span class="va">AENDTM</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive analysis start/end relative day and</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_dy.html" class="external-link">derive_vars_dy</a></span><span class="op">(</span></span>
<span>    reference_date <span class="op">=</span> <span class="va">ENRLDT</span>,</span>
<span>    source_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ASTDT</span>, <span class="va">AENDT</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive analysis duration (value and unit)</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_duration.html" class="external-link">derive_vars_duration</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">ADURN</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">ADURU</span>,</span>
<span>    start_date <span class="op">=</span> <span class="va">ASTDT</span>,</span>
<span>    end_date <span class="op">=</span> <span class="va">AENDT</span>,</span>
<span>    in_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    add_one <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    trunc_out <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/drop_unspec_vars.html" class="external-link">drop_unspec_vars</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">metatools</span><span class="fu">::</span><span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/set_variable_labels.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADAE</span> <span class="op">&lt;-</span> <span class="va">ADAE</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_variables.html" class="external-link">check_variables</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># check_ct_data(</span></span>
<span>  <span class="co">#   data = .,</span></span>
<span>  <span class="co">#   metacore = adae_metacore,</span></span>
<span>  <span class="co">#   na_acceptable = TRUE</span></span>
<span>  <span class="co"># ) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/order_cols.html" class="external-link">order_cols</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/sort_by_key.html" class="external-link">sort_by_key</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_unique_keys.html" class="external-link">check_unique_keys</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adae_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/metadata.html" class="external-link">xportr_metadata</a></span><span class="op">(</span></span>
<span>    .df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">adae_metacore</span>,</span>
<span>    verbose <span class="op">=</span> <span class="st">"stop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># xportr_type() %&gt;%</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_length.html" class="external-link">xportr_length</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_label.html" class="external-link">xportr_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_format.html" class="external-link">xportr_format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-dataset-of-questionnaires---adqs">Analysis Dataset of Questionnaires - ADQS<a class="anchor" aria-label="anchor" href="#analysis-dataset-of-questionnaires---adqs"></a>
</h3>
<p><a href="../reference/ADQS.html"><code>ADQS</code></a> dataset
contains one records per questionnaire parameter per visits per
participant with the following characteristics.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],["STUDYID","USUBJID","SUBJID","SITEID","AGE","AGEU","AGEGR1","AGEGR1N","SEX","RACE","BMI","BMIBLU","DX","AMYSTAT","ENRLFL","ENRLDT","EOSDT","EOSDTF","TRTA","TRTP","AVISIT","AVISITN","VISIT","VISITNUM","ADY","ADT","PARAM","PARAMCD","PARAMN","AVAL","AVALC","BASE","CHG","PCHG","ABLFL","QSSEQ"],["Study Identifier","Unique Subject Identifier","Subject Identifier for the Study","Study Site Identifier","Age (in Years)","Age Units","Pooled Age Group 1","Pooled Age Group 1 (N)","Sex","Race","Body Mass Index","Body Mass Index Unit","Baseline Diagnostics Status","Baseline Amyloid Status","Enrolled Population Flag","Date of Enrollment","End of Study Date","End of Study Date Imputation Flag","Actual Arm","Planned Arm","Analysis Visit","Analysis Visit (N)","Visit Name","Visit Number","Analysis Relative Day","Analysis Date","Parameter","Parameter Code","Parameter (N)","Analysis Value","Analysis Value (C)","Baseline Value","Change from Baseline","Percent Change from Baseline","Baseline Record Flag","Sequence Number"],["TEXT","TEXT","TEXT","TEXT","FLOAT","TEXT","TEXT","INTEGER","TEXT","TEXT","FLOAT","TEXT","TEXT","TEXT","TEXT","DATE","DATE","TEXT","TEXT","TEXT","TEXT","INTEGER","TEXT","INTEGER","INTEGER","DATE","TEXT","TEXT","INTEGER","FLOAT","TEXT","FLOAT","FLOAT","FLOAT","TEXT","INTEGER"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>FLDNAME<\/th>\n      <th>LABEL<\/th>\n      <th>TYPE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"searchable":["function (..., list = character(), package = NULL, lib.loc = NULL, ","    verbose = getOption(\"verbose\"), envir = .GlobalEnv, overwrite = TRUE) ","{","    fileExt <- function(x) {","        db <- grepl(\"\\\\.[^.]+\\\\.(gz|bz2|xz)$\", x)","        ans <- sub(\".*\\\\.\", \"\", x)","        ans[db] <- sub(\".*\\\\.([^.]+\\\\.)(gz|bz2|xz)$\", \"\\\\1\\\\2\", ","            x[db])","        ans","    }","    my_read_table <- function(...) {","        lcc <- Sys.getlocale(\"LC_COLLATE\")","        on.exit(Sys.setlocale(\"LC_COLLATE\", lcc))","        Sys.setlocale(\"LC_COLLATE\", \"C\")","        read.table(...)","    }","    stopifnot(is.character(list))","    names <- c(as.character(substitute(list(...))[-1L]), list)","    if (!is.null(package)) {","        if (!is.character(package)) ","            stop(\"'package' must be a character vector or NULL\")","    }","    paths <- find.package(package, lib.loc, verbose = verbose)","    if (is.null(lib.loc)) ","        paths <- c(path.package(package, TRUE), if (!length(package)) getwd(), ","            paths)","    paths <- unique(normalizePath(paths[file.exists(paths)]))","    paths <- paths[dir.exists(file.path(paths, \"data\"))]","    dataExts <- tools:::.make_file_exts(\"data\")","    if (length(names) == 0L) {","        db <- matrix(character(), nrow = 0L, ncol = 4L)","        for (path in paths) {","            entries <- NULL","            packageName <- if (file_test(\"-f\", file.path(path, ","                \"DESCRIPTION\"))) ","                basename(path)","            else \".\"","            if (file_test(\"-f\", INDEX <- file.path(path, \"Meta\", ","                \"data.rds\"))) {","                entries <- readRDS(INDEX)","            }","            else {","                dataDir <- file.path(path, \"data\")","                entries <- tools::list_files_with_type(dataDir, ","                  \"data\")","                if (length(entries)) {","                  entries <- unique(tools::file_path_sans_ext(basename(entries)))","                  entries <- cbind(entries, \"\")","                }","            }","            if (NROW(entries)) {","                if (is.matrix(entries) && ncol(entries) == 2L) ","                  db <- rbind(db, cbind(packageName, dirname(path), ","                    entries))","                else warning(gettextf(\"data index for package %s is invalid and will be ignored\", ","                  sQuote(packageName)), domain = NA, call. = FALSE)","            }","        }","        colnames(db) <- c(\"Package\", \"LibPath\", \"Item\", \"Title\")","        footer <- if (missing(package)) ","            paste0(\"Use \", sQuote(paste(\"data(package =\", \".packages(all.available = TRUE))\")), ","                \"\\n\", \"to list the data sets in all *available* packages.\")","        else NULL","        y <- list(title = \"Data sets\", header = NULL, results = db, ","            footer = footer)","        class(y) <- \"packageIQR\"","        return(y)","    }","    paths <- file.path(paths, \"data\")","    for (name in names) {","        found <- FALSE","        for (p in paths) {","            tmp_env <- if (overwrite) ","                envir","            else new.env()","            if (file_test(\"-f\", file.path(p, \"Rdata.rds\"))) {","                rds <- readRDS(file.path(p, \"Rdata.rds\"))","                if (name %in% names(rds)) {","                  found <- TRUE","                  if (verbose) ","                    message(sprintf(\"name=%s:\\t found in Rdata.rds\", ","                      name), domain = NA)","                  thispkg <- sub(\".*/([^/]*)/data$\", \"\\\\1\", p)","                  thispkg <- sub(\"_.*$\", \"\", thispkg)","                  thispkg <- paste0(\"package:\", thispkg)","                  objs <- rds[[name]]","                  lazyLoad(file.path(p, \"Rdata\"), envir = tmp_env, ","                    filter = function(x) x %in% objs)","                  break","                }","                else if (verbose) ","                  message(sprintf(\"name=%s:\\t NOT found in names() of Rdata.rds, i.e.,\\n\\t%s\\n\", ","                    name, paste(names(rds), collapse = \",\")), ","                    domain = NA)","            }","            files <- list.files(p, full.names = TRUE)","            files <- files[grep(name, files, fixed = TRUE)]","            if (length(files) > 1L) {","                o <- match(fileExt(files), dataExts, nomatch = 100L)","                paths0 <- dirname(files)","                paths0 <- factor(paths0, levels = unique(paths0))","                files <- files[order(paths0, o)]","            }","            if (length(files)) {","                for (file in files) {","                  if (verbose) ","                    message(\"name=\", name, \":\\t file= ...\", .Platform$file.sep, ","                      basename(file), \"::\\t\", appendLF = FALSE, ","                      domain = NA)","                  ext <- fileExt(file)","                  if (basename(file) != paste0(name, \".\", ext)) ","                    found <- FALSE","                  else {","                    found <- TRUE","                    switch(ext, R = , r = {","                      library(\"utils\")","                      sys.source(file, chdir = TRUE, envir = tmp_env)","                    }, RData = , rdata = , rda = load(file, envir = tmp_env), ","                      TXT = , txt = , tab = , tab.gz = , tab.bz2 = , ","                      tab.xz = , txt.gz = , txt.bz2 = , txt.xz = assign(name, ","                        my_read_table(file, header = TRUE, as.is = FALSE), ","                        envir = tmp_env), CSV = , csv = , csv.gz = , ","                      csv.bz2 = , csv.xz = assign(name, my_read_table(file, ","                        header = TRUE, sep = \";\", as.is = FALSE), ","                        envir = tmp_env), found <- FALSE)","                  }","                  if (found) ","                    break","                }","                if (verbose) ","                  message(if (!found) ","                    \"*NOT* \", \"found\", domain = NA)","            }","            if (found) ","                break","        }","        if (!found) {","            warning(gettextf(\"data set %s not found\", sQuote(name)), ","                domain = NA)","        }","        else if (!overwrite) {","            for (o in ls(envir = tmp_env, all.names = TRUE)) {","                if (exists(o, envir = envir, inherits = FALSE)) ","                  warning(gettextf(\"an object named %s already exists and will not be overwritten\", ","                    sQuote(o)))","                else assign(o, get(o, envir = tmp_env, inherits = FALSE), ","                  envir = envir)","            }","            rm(tmp_env)","        }","    }","    invisible(names)","}"],"bInfo":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"FLDNAME","targets":1},{"name":"LABEL","targets":2},{"name":"TYPE","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adqs_metacore</span> <span class="op">&lt;-</span> <span class="va">METACORES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"ADQS"</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assumed all questionnaire parameters are continuous (numeric)</span></span>
<span><span class="va">ADQS</span> <span class="op">&lt;-</span> <span class="fu">single_build_from_derived</span><span class="op">(</span></span>
<span>  metacore <span class="op">=</span> <span class="va">adqs_metacore</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"ADQS"</span>,</span>
<span>  ds_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"QS"</span> <span class="op">=</span> <span class="va">QS</span><span class="op">)</span>,</span>
<span>  predecessor_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add variable from ADSL dataset</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_merged.html" class="external-link">derive_vars_merged</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    dataset_add <span class="op">=</span> <span class="fu">single_build_from_derived</span><span class="op">(</span></span>
<span>      metacore <span class="op">=</span> <span class="va">adqs_metacore</span>,</span>
<span>      dataset_name <span class="op">=</span> <span class="st">"ADQS"</span>,</span>
<span>      ds_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ADSL"</span> <span class="op">=</span> <span class="va">ADSL</span><span class="op">)</span>,</span>
<span>      predecessor_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    new_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-one"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/verify.html" class="external-link">verify</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">QS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ADT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">ADT</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add analysis timing variable</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_vars_dy.html" class="external-link">derive_vars_dy</a></span><span class="op">(</span></span>
<span>    reference_date <span class="op">=</span> <span class="va">ENRLDT</span>,</span>
<span>    source_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ADT</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    AVISIT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">ADT</span> <span class="op">&lt;=</span> <span class="va">ENRLDT</span>, <span class="st">"BASELINE"</span>, <span class="va">VISIT</span><span class="op">)</span>,</span>
<span>    AVISITN <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">ADT</span> <span class="op">&lt;=</span> <span class="va">ENRLDT</span>, <span class="fl">0</span>, <span class="va">VISITNUM</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Re-code PARAMN</span></span>
<span>  <span class="co"># Assumed all PARAMCD are coded in the meta-specs</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/create_var_from_codelist.html" class="external-link">create_var_from_codelist</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span>,</span>
<span>    input_var <span class="op">=</span> <span class="va">PARAMCD</span>,</span>
<span>    out_var <span class="op">=</span> <span class="va">PARAMN</span>,</span>
<span>    decode_to_code <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Flag baseline records if the flag is not presented in QS</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/restrict_derivation.html" class="external-link">restrict_derivation</a></span><span class="op">(</span></span>
<span>    derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span>
<span>    args <span class="op">=</span> <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/params.html" class="external-link">params</a></span><span class="op">(</span></span>
<span>      by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span>
<span>      order <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ADT</span><span class="op">)</span>,</span>
<span>      new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span>
<span>      mode <span class="op">=</span> <span class="st">"last"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    filter <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ADT</span> <span class="op">&lt;=</span> <span class="va">ENRLDT</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive baseline and change from baseline variables</span></span>
<span>  <span class="co"># Only applicable for continuous parameters</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_var_base.html" class="external-link">derive_var_base</a></span><span class="op">(</span></span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span>
<span>    source_var <span class="op">=</span> <span class="va">AVAL</span>,</span>
<span>    new_var <span class="op">=</span> <span class="va">BASE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive change for post-baseline records</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/restrict_derivation.html" class="external-link">restrict_derivation</a></span><span class="op">(</span></span>
<span>    derivation <span class="op">=</span> <span class="va">derive_var_chg</span>,</span>
<span>    filter <span class="op">=</span> <span class="va">AVISITN</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive percentage change for post-baseline records</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/restrict_derivation.html" class="external-link">restrict_derivation</a></span><span class="op">(</span></span>
<span>    derivation <span class="op">=</span> <span class="va">derive_var_pchg</span>,</span>
<span>    filter <span class="op">=</span> <span class="va">AVISITN</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Derive sequence number</span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/admiral/reference/derive_var_obs_number.html" class="external-link">derive_var_obs_number</a></span><span class="op">(</span></span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">PARAMCD</span>, <span class="va">ADT</span><span class="op">)</span>,</span>
<span>    new_var <span class="op">=</span> <span class="va">ASEQ</span>,</span>
<span>    check_type <span class="op">=</span> <span class="st">"none"</span> <span class="co"># "error"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/drop_unspec_vars.html" class="external-link">drop_unspec_vars</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">metatools</span><span class="fu">::</span><span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/set_variable_labels.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADQS</span> <span class="op">&lt;-</span> <span class="va">ADQS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_variables.html" class="external-link">check_variables</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/check_ct_data.html" class="external-link">check_ct_data</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span>,</span>
<span>    na_acceptable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    omit_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENRLFL"</span>, <span class="st">"ABLFL"</span>, <span class="st">"PARAMCD"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/order_cols.html" class="external-link">order_cols</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pharmaverse.github.io/metatools/reference/sort_by_key.html" class="external-link">sort_by_key</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metacore <span class="op">=</span> <span class="va">adqs_metacore</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># check_unique_keys(</span></span>
<span>  <span class="co">#   data = .,</span></span>
<span>  <span class="co">#   metacore = adqs_metacore</span></span>
<span>  <span class="co"># ) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/metadata.html" class="external-link">xportr_metadata</a></span><span class="op">(</span></span>
<span>    .df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">adqs_metacore</span>,</span>
<span>    verbose <span class="op">=</span> <span class="st">"stop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># xportr_type() %&gt;%</span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_length.html" class="external-link">xportr_length</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://atorus-research.github.io/xportr/reference/xportr_label.html" class="external-link">xportr_label</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="analysis-dataset-of-adas-cog-behaviour---adadas">Analysis Dataset of ADAS-Cog Behaviour - ADADAS<a class="anchor" aria-label="anchor" href="#analysis-dataset-of-adas-cog-behaviour---adadas"></a>
</h4>
<p>Suppose the ADAS-Cog behaviors 13-item total score was the primary
outcome in the analysis, then ADAS-Cog Behavior Analysis Dataset
(<code>ADADAS</code>) can be created either directly from <a href="../reference/ADQS.html"><code>ADQS</code></a> or with a
dataset-specific metadata-specs (i.e.Â <a href="../reference/METACORES.html">adding here</a>). The following chuck
illustrate how the <code>ADADAS</code> can be created directly from
pre-generated <a href="../reference/ADQS.html"><code>ADQS</code></a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADADAS</span> <span class="op">&lt;-</span> <span class="va">ADQS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"TOTALMOD"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by ATRI Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
