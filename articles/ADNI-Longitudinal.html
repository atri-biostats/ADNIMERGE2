<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ADNI-Longitudinal â€¢ ADNIMERGE2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ADNI-Longitudinal">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ADNIMERGE2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ADNIMERGE2.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>R Package Build</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Package-Building.html">Building an R Package from Raw Dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Derived Data</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Derived-Data.html">ADNIMERGE2 Derived Data</a></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Analysis-Meta-Specs.html">ADNIMERGE2 Analysis Metadata Specs</a></li>
    <li><a class="dropdown-item" href="../articles/ADNIMERGE2-Analysis-Data.html">ADNIMERGE2 Analysis Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADNI Summaries</h6></li>
    <li><a class="dropdown-item" href="../articles/ADNI-Enrollment.html">ADNI Enrollment</a></li>
    <li><a class="dropdown-item" href="../articles/ADNI-Longitudinal.html">ADNI Longitudinal Summaries</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Versions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atri-biostats/ADNIMERGE2/" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ADNI-Longitudinal</h1>
            
            <h4 data-toc-skip class="date">Last Updated: July 25,
2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/atri-biostats/ADNIMERGE2/blob/HEAD/vignettes/ADNI-Longitudinal.Rmd" class="external-link"><code>vignettes/ADNI-Longitudinal.Rmd</code></a></small>
      <div class="d-none name"><code>ADNI-Longitudinal.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article demonstrate how to use the <code>ADNIMERGE2</code> R
package to generate simple longitudinal summaries of clinical cognitive
outcomes. The analysis results that are presented in this article are
merely for illustration purpose.</p>
</div>
<div class="section level2">
<h2 id="load-required-r-packages">Load Required R Packages<a class="anchor" aria-label="anchor" href="#load-required-r-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marginaleffects.com/" class="external-link">marginaleffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atri-biostats.github.io/ADNIMERGE2">ADNIMERGE2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Color for DX group</span></span>
<span><span class="va">dx_color_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#73C186"</span>, <span class="st">"#F2B974"</span>, <span class="st">"#DF957C"</span>, <span class="st">"#999999"</span><span class="op">)</span></span>
<span><span class="va">month_bin</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Anticipated ADAS-cog assessment collection timeline for DEM - 2 years</span></span>
<span><span class="va">year2</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">month_bin</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adni-longitudinal-summaries---clinical-cognitive-outcomes">ADNI Longitudinal Summaries - Clinical Cognitive Outcomes<a class="anchor" aria-label="anchor" href="#adni-longitudinal-summaries---clinical-cognitive-outcomes"></a>
</h2>
<div class="section level3">
<h3 id="adas-cog-item-13-total-score">ADAS-Cog Item-13 Total Score<a class="anchor" aria-label="anchor" href="#adas-cog-item-13-total-score"></a>
</h3>
<p>The following r chucks are used to summarize the ADAS-Cognitive
Behavior item-13 total score (ADAS-Cog) over time. Individualâ€™s score
trajectory by corresponding baseline diagnostics status, summary result
of a hierarchical model fit, and predicted scores overtime by baseline
diagnosis status are presented in this section.</p>
<div class="section level4">
<h4 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<p>The analysis will based on enrolled subjects in the ADNI study with
known baseline diagnostics summary and that have at least one assessment
score. The analysis population is summarized in the following
diagram.</p>
<p><img src="ADNI-Longitudinal_files/figure-html/consort-diagram-1.png" alt="Analysis Population Diagram" width="850"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare analysis dataset of ADAS-cog item-13 score</span></span>
<span><span class="va">ADADAS</span> <span class="op">&lt;-</span> <span class="va">ADQS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Enrolled participant</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ENRLFL</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Y"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># ADAS-cog item-13 total score</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"ADASTT13"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Compute time variable in month</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="fu"><a href="../reference/convert_number_days.html">convert_number_days</a></span><span class="op">(</span><span class="va">AVISITN</span>, bin <span class="op">=</span> <span class="va">month_bin</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># visit date data imputation from registry</span></span>
<span>  <span class="co"># filter(is.na(TIME), !is.na(DX), !is.na(AVAL))</span></span>
<span>  <span class="co"># For spline term in the model</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TIME"</span>, <span class="st">"DX"</span>, <span class="st">"AVAL"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individual-profile-plot">Individual Profile Plot<a class="anchor" aria-label="anchor" href="#individual-profile-plot"></a>
</h4>
<p>The individual profile of ADAS-Cog item-13 total score over time by
baseline diagnostics group is presented below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Individual profile (spaghetti) plot</span></span>
<span><span class="va">individual_profile_plot</span> <span class="op">&lt;-</span> <span class="va">ADADAS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">AVAL</span>, group <span class="op">=</span> <span class="va">USUBJID</span>, color <span class="op">=</span> <span class="va">DX</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">year2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">dx_color_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"ADAS-cog Item-13 Total Score"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Months since baseline visit"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Baseline Diagnostics Status"</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"Based on known baseline diagnostics status "</span>,</span>
<span>      <span class="st">"(i.e., any missing diagnostics status is excluded)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span><span class="va">individual_profile_plot</span></span></code></pre></div>
<p><img src="ADNI-Longitudinal_files/figure-html/indiv-profile-plot-1.png" alt="Individual profile plot" width="700"></p>
</div>
<div class="section level4">
<h4 id="model-fit">Model Fit<a class="anchor" aria-label="anchor" href="#model-fit"></a>
</h4>
<p>A linear mixed model with spline term of continuous time variable can
be used to analysis the longitudinal ADAS-Cog score using
<code>lme4</code> R package.</p>
<p>The following terms are included in the mixed effect model:</p>
<ul>
<li><p>Main effect of baseline diagnostics status (<code>DX</code>): To
account any baseline difference of ADAS-cog item-13 total score among
diagnostics status. In a clinical trial study, it is often to assume the
same subject characteristics between treatment group at baseline visit
which is a strong assumption. Unlike a clinical trial study, subject
characteristics might be different at baseline visit in an observation
study. Thus, this term is included here due to the design of ADNI study
which is an observational study.</p></li>
<li><p>Interaction term between time and baseline diagnostics status
(<code>TIME:DX</code>): To account for any difference of the ADAS-cog
assessment item-13 total score among diagnostics status
overtime.</p></li>
<li><p>Random intercept and random slope terms
(<code>TIME|USUBJID</code>): To account the repeated measurements per
subject. It seems subjects have different baseline ADAS-cog item-13
total score as shown in the above individual profile plot (random
intercept: <code>|USUBJID</code>) and subject might also have different
trajectory overtime (<code>TIME|</code>).</p></li>
<li><p>Spline terms (<code>ns</code>): To considered any non-linear
progression trajectory in the model (i.e., non-linear effect of time in
the model).</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Spline term defined in the global environment</span></span>
<span><span class="va">ns21</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span>,</span>
<span>    df <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, <span class="va">t</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ns22</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span>,</span>
<span>    df <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, <span class="va">t</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">"ns21"</span>, <span class="va">ns21</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">"ns22"</span>, <span class="va">ns22</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit linear mixed effect model using spline terms to account</span></span>
<span><span class="co">#  non-linear trend of time effect</span></span>
<span></span>
<span><span class="co"># With a random slope term ----</span></span>
<span><span class="va">lmer_mod_fit</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">AVAL</span> <span class="op">~</span> <span class="va">DX</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu">ns21</span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu">ns22</span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu">ns21</span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu">ns22</span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">DX</span> <span class="op">+</span> <span class="op">(</span><span class="va">TIME</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ADADAS</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"Nelder_Mead"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue</span></span>
<span><span class="co">#&gt;  - Rescale variables?</span></span>
<span></span>
<span><span class="va">lmer_mod_fit</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: AVAL ~ DX + I(ns21(TIME)) + I(ns22(TIME)) + (I(ns21(TIME)) +  </span></span>
<span><span class="co">#&gt;     I(ns22(TIME))):DX + (TIME | USUBJID)</span></span>
<span><span class="co">#&gt;    Data: ADADAS</span></span>
<span><span class="co">#&gt; REML criterion at convergence: 72928.55</span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Std.Dev. Corr</span></span>
<span><span class="co">#&gt;  USUBJID  (Intercept) 5.5581       </span></span>
<span><span class="co">#&gt;           TIME        0.1763   0.51</span></span>
<span><span class="co">#&gt;  Residual             3.3815       </span></span>
<span><span class="co">#&gt; Number of obs: 11922, groups:  USUBJID, 2810</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt;         (Intercept)                DXMCI                DXDEM  </span></span>
<span><span class="co">#&gt;               8.806                7.298               21.044  </span></span>
<span><span class="co">#&gt;       I(ns21(TIME))        I(ns22(TIME))  DXMCI:I(ns21(TIME))  </span></span>
<span><span class="co">#&gt;              11.435               21.456               28.298  </span></span>
<span><span class="co">#&gt; DXDEM:I(ns21(TIME))  DXMCI:I(ns22(TIME))  DXDEM:I(ns22(TIME))  </span></span>
<span><span class="co">#&gt;              69.289               32.062               48.478  </span></span>
<span><span class="co">#&gt; optimizer (Nelder_Mead) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</span></span></code></pre></div>
<ul>
<li>
<strong>Model Assumption Check: </strong> <a href="https://easystats.github.io/performance/reference/check_model.html" class="external-link"><code>performance::check_model</code></a>
function could be used to generate model assumption check (i.e., model
diagnostic) plots.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="co"># To relabel x-axis and getting ggplot2 object, set panel = FALSE</span></span>
<span><span class="va">model_check</span> <span class="op">&lt;-</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html" class="external-link">check_model</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">lmer_mod_fit</span>,</span>
<span>  check <span class="op">=</span> <span class="st">"pp_check"</span>,</span>
<span>  panel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_check</span><span class="op">)</span></span>
<span><span class="va">model_check</span><span class="op">$</span><span class="va">PP_CHECK</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"ADAS-cog Item-13 Total Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ADNI-Longitudinal_files/figure-html/model-check-1.png" alt="Posterior predictive plot - model assumptions check" width="700"></p>
</div>
<div class="section level4">
<h4 id="population-level-model-prediction">Population-Level Model Prediction<a class="anchor" aria-label="anchor" href="#population-level-model-prediction"></a>
</h4>
<p><em>NOTE: </em></p>
<ul>
<li>The prediction timeline for Dementia (DEM) diagnostics status was
limited to 24 monthsdue to the anticipated follow-up collection of ADAS
cognitive behaviour assessmentwhich is up-to 2 years due to the study
design. However, ADAS-cog assessment might have been collected for
rollover subjects with DEM baseline diagnostics status during their
initial visit.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Population level prediction</span></span>
<span><span class="va">pred_value</span> <span class="op">&lt;-</span> <span class="fu">marginaleffects</span><span class="fu">::</span><span class="fu"><a href="https://marginaleffects.com/man/r/predictions.html" class="external-link">predictions</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">lmer_mod_fit</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>    TIME <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADADAS</span><span class="op">$</span><span class="va">TIME</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>    DX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">ADSL</span><span class="op">$</span><span class="va">DX</span><span class="op">)</span>,</span>
<span>    USUBJID <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">DX</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"DEM"</span> <span class="op">&amp;</span> <span class="va">TIME</span> <span class="op">&gt;</span> <span class="va">year2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">predicted_plot</span> <span class="op">&lt;-</span> <span class="va">pred_value</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">estimate</span>, color <span class="op">=</span> <span class="va">DX</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span>, fill <span class="op">=</span> <span class="va">DX</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.15</span>, linetype <span class="op">=</span> <span class="fl">0</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pred_value</span><span class="op">$</span><span class="va">TIME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">year2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">dx_color_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">dx_color_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Months since baseline visit"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Estimated ADAS-cog Item-13 \n Total Score with 95% CI"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Baseline Diagnostics Status"</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"The prediction timeline for Dementia (DEM) diagnostics status was limited"</span>,</span>
<span>      <span class="st">" to 24 months due to the\n anticipated follow-up assessment collection"</span>,</span>
<span>      <span class="st">" due to study design."</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">predicted_plot</span></span></code></pre></div>
<p><img src="ADNI-Longitudinal_files/figure-html/model-predict-1.png" alt="Estimated score by baseline diagnostics status" width="700"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by ATRI Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
